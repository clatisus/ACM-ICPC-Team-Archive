## [F. Substrings in a String](http://codeforces.com/contest/914/problem/F)

**题目大意**：

给出一个长度为$n\le10^5$的只由小写字母组成的字符串$s$，之后给出$q$次操作，每次操作是以下两种之一：

- 修改字符串$s$的位置$x$为给定的小写字母

- 给出一个字符串$t$，问它在$s[l\cdots r]$中出现的次数

保证第二种操作中字符串的总长度不超过$10^5$

**题解**：

因为询问的字符串总长度不超过$10^5$，我们可以取$K$约等于$\sqrt{10^5}$，这样操作2中长度大于$K$的串最多有$\sqrt{10^5}$个，这些串直接和$s$串进行一次`kmp`即可。


对于长度不大于$K$的询问串$t$，我们将$s$按大小$K$分块，这样就保证了$t$只会出现在$s$的某块内或者是横跨相邻两块。

对于$s$的每一块，维护一个`sam`来计算块内的出现次数，每当修改的时候重新构建这一块的`sam`。

对于横跨两块的部分，只需要拿出$2(|t|-1)$长的部分与$t$做一次`kmp`即可。

总的时间复杂度$O(n\sqrt{n})$，空间复杂度$O(n)$。