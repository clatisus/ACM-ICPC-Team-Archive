## [E - BBQ Hard](https://agc001.contest.atcoder.jp/tasks/agc001_e)

**题目大意：**

有$n\le2\times10^5$包物品，第$i$包物品中有$A$类物品$1\le A_i\le2000$个，$B$类物品$1\le B_i\le2000$个，同类的物品个体之间不存在差异。

现在要从中取出两包物品，将其中的物品都取出，再将其中的物品按某种顺序排列，问有多少种不同的方案。

两种方案不同当前仅当选择的两包物品不同，或者其中物品的排列顺序不同。

**题解：**

如果确定选择第$i$包和第$j$包物品，则不同的方案共有$\displaystyle \frac{(A_i+A_j+B_i+B_j)!}{(A_i+A_j)!(B_i+B_j)!}$.

这个几何意义可以是从只能向上和向右走的网格中从$(-A_i,-B_i)$走到$(A_j,B_j)$的方案数。

因此可以用`dp`求出从$(-A_1,-B_1),\cdots,(-A_n,-B_n)$中任意位置出发走到$(A_i,B_i)$的方案数求和，再减去从$(-A_i,-B_i)$走到$(A_i,B_i)$的方案数之和，最后再除以$2$消序即可。

时空复杂度$O(n+m^2)$，其中$m$为坐标范围。