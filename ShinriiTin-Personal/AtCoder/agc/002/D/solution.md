## [D - Stamp Rally](https://agc002.contest.atcoder.jp/tasks/agc002_d)

**题目大意：**

给出一张无向连通图，点数和边数分别为$1\le n,m\le10^5$。

有$q\le10^5$次询问，每次询问至少需要用到编号不大于多少的边，才能使得与$x$和$y$两个点至少一个点连通的点数不少于$z$.

**题解：**

**方法一：**

考虑对边分块，取块大小$K=\sqrt{m}$，用并查集维护连通块大小，先找到每组询问答案所在块编号，再枚举答案判断。

时间复杂度$O(q\sqrt{m}+n+m)$，空间复杂度$O(n+m+q)$.

**方法二：**

单独考虑每组询问，显然可以二分答案，并查集判断。

于是我们使用整体二分，但是每次重建并查集代价太高，可以考虑按`bfs`的顺序访问整体二分的树结构。

这样每层的区间中点是有序的，按顺序加边即可，而进入新的一层的时候则需要重置并查集。

因为二分的树结构只有$O(\log{m})$层，因此时间复杂度为$O((n+m+q)\log{m})$.