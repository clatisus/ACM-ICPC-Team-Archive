## [F - Leftmost Ball](https://agc002.contest.atcoder.jp/tasks/agc002_f)

**题目大意：**

有$n\le2000$种颜色的球，每种颜色都有$k\le2000$个，现在将它们放在一行任意排列，然后将每种颜色最左边的球染色成$0$号颜色（与$n$种颜色都不同），问最终有多少种不同的局面。

**题解：**

考虑如何一个最终局面是否合法。最终局面合法，当且仅当，将出现的颜色按除了$0$号颜色之外的每种颜色最左边的球的顺序重新编号，第$i$种颜色的球左边至少有$i$个白球。

因此可以用$f[i][j]$表示仅考虑有$i$个$0$号球，$j$种不同颜色的球的不同局面数量，则答案为$f[n][n]\times n!$。

显然$f[0][0]=1$，$f[i][j]$则需要考虑当前最左边的球放$0$号球还是放$j$种颜色中编号最小的颜色的球。

- 如果放$0$号球（要求$i>0$），则有$f[i-1][j]$种方案；

- 如果不放$0$号球（要求$j>i$），则需要先将该种颜色的其余$k-2$个球的位置决定好，然后转化为子问题$f[i][j-1]$，共$\displaystyle\binom{i+j(k-1)-1}{k-2}\times f[i][j-1]$种方案；

时空复杂度$O(n(n+k))$，注意要特判$k=1$，此时显然只有一种方案。